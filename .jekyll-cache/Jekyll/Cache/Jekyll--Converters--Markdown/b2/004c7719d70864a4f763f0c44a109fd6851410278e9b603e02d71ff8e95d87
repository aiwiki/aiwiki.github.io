I"ÏQ<h2 id="ná»™i-dung">Ná»™i dung</h2>
<ul>
  <li><a href="#-dinh-nghia">1. Äá»‹nh nghÄ©a Markov chain</a></li>
  <li><a href="#-bai-toan-sang-nay-an-gi">2. BÃ i toÃ¡n â€œsÃ¡ng nay Äƒn gÃ¬â€</a></li>
  <li><a href="#-tong-ket">3. Tá»•ng káº¿t</a></li>
</ul>

<p>Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ Ä‘i qua sÆ¡ lÆ°á»£c vá» Ä‘á»‹nh nghÄ©a cá»§a Markov chain, tá»« Ä‘Ã³ hiá»ƒu thÃªm vá» Markov chain Ä‘á»ƒ á»©ng dá»¥ng vÃ o má»™t bÃ i toÃ¡n vÃ  thá»±c nghiá»‡m báº±ng Python.</p>

<p><a name="-dinh-nghia"></a></p>

<h3 id="1-Ä‘á»‹nh-nghÄ©a-markov-chain">1. Äá»‹nh nghÄ©a Markov chain</h3>

<p>Markov chain (<a href="https://en.wikipedia.org/wiki/Markov_chain" target="_blank">chuá»—i Markov</a>), Ä‘Æ°á»£c Ä‘áº·t theo tÃªn nhÃ  toÃ¡n há»c ngÆ°á»i Nga <a href="https://en.wikipedia.org/wiki/Andrey_Markov" target="_blank">Andrey Markov</a>, lÃ  má»™t mÃ´ hÃ¬nh ngáº«u nhiÃªn hay <a href="https://en.wikipedia.org/wiki/Stochastic_process" target="_blank">tiáº¿n trÃ¬nh ngáº«u nhiÃªn</a> mÃ´ táº£ má»™t chuá»—i cÃ¡c sá»± kiá»‡n cÃ³ kháº£ nÄƒng xáº£y ra, mÃ  xÃ¡c suáº¥t Ä‘á»ƒ xáº£y ra sá»± kiá»‡n tiáº¿p theo phá»¥ thuá»™c chá»‰ vÃ o sá»± kiá»‡n hiá»‡n táº¡i. ÄÃ¢y lÃ  má»™t mÃ´ hÃ¬nh <em>â€œkhÃ´ng cÃ³ trÃ­ nhá»›â€</em> (memorylessness), nghÄ©a lÃ  cÃ¡c sá»± kiá»‡n xáº£y ra trong quÃ¡ khá»© sáº½ khÃ´ng Ä‘Æ°á»£c ghi nhá»›, sá»± kiá»‡n trong tÆ°Æ¡ng lai chá»‰ phá»¥ thuá»™c sá»± kiá»‡n hiá»‡n táº¡i cá»§a mÃ´ hÃ¬nh.</p>

<p>Markov chain lÃ  sá»± káº¿t há»£p bá»Ÿi 2 thÃ nh pháº§n: táº­p tráº¡ng thÃ¡i $Q$ vÃ  ma tráº­n chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c tráº¡ng thÃ¡i $P$ (ma tráº­n nÃ y sáº½ lÃ  ma tráº­n vuÃ´ng).</p>

<p><strong>VÃ­ dá»¥</strong>, ta Ä‘á»‹nh nghÄ©a Markov chain $\text{MC}$ cÃ³:</p>
<ul>
  <li>Táº­p tráº¡ng thÃ¡i lÃ  $Q = { Q_1, Q_2, Q_3 }$</li>
  <li>Ma tráº­n chuyá»ƒn Ä‘á»•i giá»©a cÃ¡c tráº¡ng thÃ¡i lÃ  $\begin{aligned} P = \begin{bmatrix} P_{11} &amp; P_{12} &amp; P_{13} \newline P_{21} &amp; P_{22} &amp; P_{23} \newline P_{31} &amp; P_{32} &amp; P_{33} \end{bmatrix}\end{aligned}$</li>
</ul>

<p>Markov chain $\text{MC}$ sáº½ cÃ³ hÃ¬nh dáº¡ng trÃ´ng giá»‘ng nhÆ° má»™t Ä‘á»“ thá»‹ cÃ³ hÆ°á»›ng, cÃ³ trá»ng sá»‘, vá»›i cÃ¡c node trÃªn Ä‘á»“ thá»‹ lÃ  cÃ¡c tráº¡ng thÃ¡i trong táº­p tráº¡ng thÃ¡i cá»§a Markov chain, vÃ  cÃ¡c trá»ng sá»‘ trÃªn cÃ¡c cáº¡nh cá»§a Ä‘á»“ thá»‹ mÃ´ táº£ xÃ¡c suáº¥t chuyá»ƒn $P_{ij}$, lÃ  xÃ¡c suáº¥t Ä‘á»ƒ di chuyá»ƒn tá»« tráº¡ng thÃ¡i $Q_i$ Ä‘áº¿n tráº¡ng thÃ¡i $Q_j$. Náº¿u $P_{ij} = 0$, ta ngáº§m hiá»ƒu ráº±ng khÃ´ng thá»ƒ di chuyá»ƒn giá»¯a hai tráº¡ng thÃ¡i $Q_i$ vÃ  $Q_j$. âš ï¸ <strong>LÆ°u Ã½</strong> lÃ  cÃ¡c tráº¡ng thÃ¡i cÅ©ng cÃ³ thá»ƒ quay trá»Ÿ vá» chÃ­nh nÃ³, vÃ­ dá»¥ $P_{33}$ lÃ  xÃ¡c suáº¥t Ä‘á»ƒ thá»i Ä‘iá»ƒm hiá»‡n táº¡i, Markov chain Ä‘ang á»Ÿ tráº¡ng thÃ¡i $Q_3$ vÃ  thá»i Ä‘iá»ƒm tiáº¿p theo sáº½ quay trá»Ÿ láº¡i $Q_3$. HÃ¬nh dÆ°á»›i Ä‘Ã¢y mÃ´ táº£ Markov chain $\text{MC}$.</p>

<p><img src="https://raw.githubusercontent.com/tuanio/tuanio.github.io/main/assets/markov_chain/mc_ex.png" alt="mc_ex" /></p>

<p>Äá»ƒ quan sÃ¡t Ä‘Æ°á»£c Ä‘Æ°á»ng Ä‘i cá»§a cÃ¡c tráº¡ng thÃ¡i trong Markov chain, ta cáº§n Ä‘á»‹nh nghÄ©a quan sÃ¡t $X = (X_1, X_2, \cdots, X_t, \cdots, X_T)$ lÃ  má»™t vector cÃ³ $T$ thÃ nh pháº§n, mÃ´ táº£ cÃ¡c quan sÃ¡t cá»§a Markov chain theo thá»i gian, $X_t \in Q$. $X=(X_1 = Q_1, X_2 = Q_1, X_3 = Q_2, X_4 = Q_3)$ lÃ  má»™t vÃ­ dá»¥ vá» chuá»—i quan sÃ¡t cÃ¡c tráº¡ng thÃ¡i cá»§a Markov chain, vá»›i xÃ¡c suáº¥t xáº£y ra chuá»—i quan sÃ¡t nÃ y lÃ  tÃ­ch cÃ¡c xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i, $P(X) = \prod_{i=1}^{T-1} X_{i}X_{i+1}$, trong vÃ­ dá»¥ cá»§a chÃºng ta thÃ¬ sáº½ lÃ  $P(X) = P_{11}P_{12}P_{23}$, trÃªn thá»±c táº¿, ta cÃ³ thá»ƒ láº¥y logarit cá»§a $P(X)$, táº¡o thuáº­n lá»£i cho viá»‡c tÃ­nh toÃ¡n, trÃ¡nh bá»‹ trÃ n sá»‘ trong cÃ¡c chÆ°Æ¡ng trÃ¬nh mÃ¡y tÃ­nh.</p>

<p>Cá»¥ thá»ƒ hÆ¡n vá» kÃ½ hiá»‡u toÃ¡n há»c cá»§a xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i, $P_{ij}=Pr(X_{t+1} = Q_j|X_t = Q_i)$ lÃ  xÃ¡c suáº¥t Ä‘á»ƒ thá»i Ä‘iá»ƒm $t$, tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a Markov chain lÃ  $Q_i$, vÃ  tráº¡ng thÃ¡i cá»§a quan sÃ¡t trong tÆ°Æ¡ng lai $t+1$ lÃ  $Q_{j}$.</p>

<p><a name="-bai-toan-sang-nay-an-gi"></a></p>

<h3 id="2-bÃ i-toÃ¡n-sÃ¡ng-nay-Äƒn-gÃ¬">2. BÃ i toÃ¡n â€œSÃ¡ng nay Äƒn gÃ¬â€</h3>

<p>Giáº£ sá»­ vÃ o má»™t buá»•i sÃ¡ng ná», báº¡n thá»©c dáº­y vá»›i 2 láº§n reo chuÃ´ng bÃ¡o thá»©c Ä‘Ã£ qua tá»« Ä‘iá»‡n thoáº¡i, báº¡n ngá»“i dáº­y, vá»›i cÃ¡i bá»¥ng Ä‘ang reo lÃªn, báº¡n liá»n suy nghÄ© Ä‘áº¿n viá»‡c: sÃ¡ng hÃ´m nay mÃ¬nh sáº½ Äƒn gÃ¬?. Sau khi ra Ä‘áº§u ngÃµ, báº¡n Ä‘á»©ng trÆ°á»›c â€œngÃ£ tÆ°â€: quÃ¡n phá»Ÿ cÃ´ Ba, xe bÃ¡nh mÃ¬ cÃ´ Hai, cÆ¡m táº¥m chÃº SÃ¡u vÃ  xe sÃºp cua cá»§a Ã´ng Báº£y. Tuy ráº±ng, báº¡n Ä‘Ã£ Äƒn sÃ¡ng máº¥y chá»¥c nÄƒm cuá»™c Ä‘á»i rá»“i, nhÆ°ng viá»‡c lá»±a chá»n mÃ³n Äƒn chÆ°a bao giá» lÃ  dá»… cáº£. May máº¯n thay, trong má»™t nÄƒm vá»«a qua, mÃ³n Äƒn sÃ¡ng cá»§a má»—i ngÃ y Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c báº¡n lÆ°u trá»¯ trÃªn Ä‘iá»‡n thoáº¡i, trong á»©ng dá»¥ng ghi chÃº (Ä‘Ã¢y chÃ­nh lÃ  data quÃ½ giÃ¡). Sau khi Ä‘á»c Ä‘á»‹nh nghÄ©a vá» Markov chain á»Ÿ trÃªn, báº¡n quyáº¿t Ä‘á»‹nh Ã¡p dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t bÃ i toÃ¡n â€œsÃ¡ng nay Äƒn gÃ¬â€ nÃ y.</p>

<p>ÄÃ³ chá»‰ lÃ  má»™t cÃ¢u chuyá»‡n vui do tÃ´i bá»‹a ra Ä‘á»ƒ dáº«n vÃ o bÃ i toÃ¡n cÃ³ thá»ƒ giáº£i quyáº¿t báº±ng Markov chain nÃ y. TrÃªn thá»±c táº¿, Markov chain cÃ³ thá»ƒ giáº£i cÃ¡c bÃ i toÃ¡n to lá»›n hÆ¡n, nhÆ°ng trÆ°á»›c tiÃªn chÃºng ta cá»© giáº£i bÃ i toÃ¡n kia Ä‘á»ƒ báº¡n cÃ³ thá»ƒ láº¥p Ä‘áº§y cÃ¡i bá»¥ng Ä‘Ã£.</p>

<p>Trong vÃ­ dá»¥ nÃ y, tÃ´i sáº½ hiá»‡n thá»±c báº±ng Python, Ä‘á»c data theo thá»i gian lÃªn vÃ  tÃ¬m bá»™ cÃ¡c tráº¡ng thÃ¡i $Q$, rá»“i tÃ¬m xÃ¡c suáº¥t cá»§a ma tráº­n $P$ kia, sau Ä‘Ã³ chá»n ngáº«u nhiÃªn tráº¡ng thÃ¡i (mÃ³n Äƒn sÃ¡ng) tiáº¿p theo trÃªn phÃ¢n phá»‘i Ä‘Ã£ biáº¿t cá»§a xÃ¡c suáº¥t cá»§a tráº¡ng thÃ¡i (mÃ³n Äƒn) hiá»‡n táº¡i. Báº¡n cÃ³ thá»ƒ táº£i data á»Ÿ <a href="https://github.com/tuanio/tuanio.github.io/blob/main/assets/markov_chain/code/breakfast.csv" target="_blank">Ä‘Ã¢y</a></p>

<p>Äá»‘i vá»›i bá»™ data á»Ÿ trÃªn, táº­p tráº¡ng thÃ¡i cá»§a chÃºng ta sáº½ lÃ  $Q={\text{Phá»Ÿ}, \text{CÆ¡m táº¥m}, \text{BÃ¡nh mÃ¬}, \text{SÃºp cua}}$</p>

<p>TrÆ°á»›c tiÃªn ta sáº½ pháº£i import cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t vÃ o Python</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> <span class="c1"># tÃ­nh toÃ¡n trÃªn ma tráº­n
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> <span class="c1"># Ä‘á»c dá»¯ liá»‡u tá»« file csv
</span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span> <span class="c1"># dÃ¹ng cho má»¥c Ä‘Ã­ch in "Ä‘áº¹p"
</span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span> <span class="c1"># Ä‘á»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng láº§n xáº£y ra cá»§a cÃ¡c tráº¡ng thÃ¡i (Ä‘Æ¡n láº» vÃ  cáº·p)
</span></code></pre></div></div>

<p>Äá»c dá»¯ liá»‡u vÃ  chuyá»ƒn thÃ nh dáº¡ng list trong Python Ä‘á»ƒ dá»… dÃ ng sá»­ dá»¥ng</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'breakfast.csv'</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">Food</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="c1"># xuáº¥t ra 5 mÃ³n Äƒn cuá»‘i cÃ¹ng báº¡n Äƒn
</span></code></pre></div></div>
<pre><code class="language-plain">['Phá»Ÿ', 'CÆ¡m táº¥m', 'BÃ¡nh mÃ¬', 'Phá»Ÿ', 'Phá»Ÿ']
</code></pre>

<p>Äá»ƒ cÃ³ thá»ƒ táº¡o ma tráº­n P, trÆ°á»›c tiÃªn ta pháº£i Ä‘áº¿m cÃ¡c cáº·p vÃ  cÃ¡c giÃ¡ trá»‹ Ä‘Æ¡n láº» trÆ°á»›c, sau Ä‘Ã³ Ä‘i chuáº©n hÃ³a</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># táº¡o nÆ¡i lÆ°u trá»¯ giÃ¡ trá»‹
</span><span class="n">food_count</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">food_pair_count</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</code></pre></div></div>

<p>Äáº¿m cÃ¡c giÃ¡ trá»‹</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># food_count: Ä‘áº¿m sá»‘ láº§n xuáº¥t hiá»‡n cá»§a má»™t tráº¡ng thÃ¡i
# food_pair_count: Ä‘áº¿m táº¥t cáº£ cÃ¡c cáº·p tráº¡ng thÃ¡i cÃ³ thá»ƒ [current][future]
</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">food_count</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># self loop
</span>        <span class="n">food_pair_count</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">break</span>
    <span class="n">food_pair_count</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>Chuáº©n hÃ³a theo tá»•ng hÃ ng</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># chuáº©n hÃ³a theo tá»•ng hÃ ng
</span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">food_pair_count</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">food_pair_count</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">/=</span> <span class="n">food_count</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="c1"># chuáº©n hÃ³a
</span></code></pre></div></div>

<p>Do ma tráº­n khÃ´ng giá»‘ng nhÆ° dictionary trong Python, ta chá»‰ cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c báº±ng chá»‰ má»¥c (index) cá»§a tráº¡ng thÃ¡i, vÃ¬ váº­y ta cáº§n pháº£i cÃ³ má»™t dictionary lÆ°u trá»¯ cÃ¡c index cá»§a cÃ¡c tráº¡ng thÃ¡i</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># láº¥y index cá»§a cÃ¡c mÃ³n Äƒn Ä‘á»ƒ dá»… thao tÃ¡c
</span><span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">food_count</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span>
<span class="n">key_to_idx</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span> <span class="c1"># key to index
</span><span class="k">print</span><span class="p">(</span><span class="n">key_to_idx</span><span class="p">)</span>
</code></pre></div></div>
<pre><code class="language-plain">{'BÃ¡nh mÃ¬': 0, 'CÆ¡m táº¥m': 1, 'Phá»Ÿ': 2, 'SÃºp cua': 3}
</code></pre>

<p>Ta bÃ¢y giá» cÃ³ thá»ƒ táº¡o ma tráº­n $P$ tá»« xÃ¡c suáº¥t Ä‘Ã£ chuáº©n hÃ³a tá»« bÆ°á»›c trÃªn, vÃ  nÃªn chuyá»ƒn tá»« list sang numpy Ä‘á»ƒ tiá»‡n lá»£i cho viá»‡c tÃ­nh toÃ¡n hÆ¡n, do numpy lÃ  má»™t thÆ° viá»‡n ráº¥t máº¡nh cá»§a Python trong viá»‡c xá»­ lÃ½ cÃ¡c thao tÃ¡c liÃªn quan Ä‘áº¿n Ä‘áº¡i sá»‘ tuyáº¿n tÃ­nh.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">P</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">food_pair_count</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">P</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">values</span><span class="p">()))</span>
        
<span class="c1"># chuyá»ƒn list sang numpy Ä‘á»ƒ dá»… tÃ­nh toÃ¡n
</span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Ma tráº­n chuyá»ƒn tráº¡ng thÃ¡i P: '</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</code></pre></div></div>
<pre><code class="language-plain">Ma tráº­n chuyá»ƒn tráº¡ng thÃ¡i P: 
array([[0.26582278, 0.26582278, 0.26582278, 0.20253165],
       [0.25274725, 0.20879121, 0.24175824, 0.2967033 ],
       [0.28571429, 0.25274725, 0.28571429, 0.17582418],
       [0.25961538, 0.33653846, 0.21153846, 0.19230769]])
</code></pre>

<p>Ta cÃ³ thá»ƒ kiá»ƒm tra tá»•ng hÃ ng xem cÃ³ báº±ng $1$ hay chÆ°a, náº¿u chÆ°a cÃ³ thá»ƒ do lá»—i á»Ÿ cÃ¡c bÆ°á»›c trÆ°á»›c.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># tá»•ng hÃ ng cá»§a ma tráº­n pháº£i luÃ´n báº±ng 1
</span><span class="k">print</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>
<pre><code class="language-plain">[1. 1. 1. 1.] # táº¥t cáº£ Ä‘á»u 1, chuáº©n 
</code></pre>

<p>BÃ¢y giá», pháº§n cuá»‘i sáº½ Ä‘i dá»± Ä‘oÃ¡n mÃ³n Äƒn. Viá»‡c dá»± Ä‘oÃ¡n mÃ³n Äƒn (tráº¡ng thÃ¡i) tÆ°Æ¡ng lai khÃ¡ Ä‘Æ¡n giáº£n, ta cÃ³ thá»ƒ hÃ¬nh dung tháº¿ nÃ y: Ä‘á»©ng á»Ÿ node cá»§a tráº¡ng thÃ¡i hiá»‡n táº¡i (mÃ³n Äƒn cuá»‘i cÃ¹ng cá»§a táº­p dá»¯ liá»‡u - mÃ³n Äƒn hÃ´m trÆ°á»›c), cÃ³ má»™t táº­p cÃ¡c giÃ¡ trá»‹ xÃ¡c suáº¥t tÆ°Æ¡ng á»©ng vá»›i trá»ng sá»‘ cá»§a cÃ¡c cáº¡nh Ä‘á»ƒ Ä‘i Ä‘áº¿n node khÃ¡c, chá»n ngáº«u nhiÃªn má»™t node Ä‘á»ƒ Ä‘i Ä‘áº¿n tá»« táº­p xÃ¡c suáº¥t Ä‘Ã³ (má»™t phÃ¢n phá»‘i), vÃ  ta cÃ³ thá»ƒ chá»n ngáº«u nhiÃªn theo phÃ¢n phá»‘i vá»›i hÃ m <code class="language-plaintext highlighter-rouge">numpy.random.choice</code>.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># dá»± Ä‘oÃ¡n mÃ³n Äƒn 
</span><span class="n">curr_food</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">curr_distribution</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">key_to_idx</span><span class="p">[</span><span class="n">curr_food</span><span class="p">]]</span>
<span class="n">predicted_food</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">curr_distribution</span><span class="p">)</span> <span class="c1"># random walk with known distribution
</span><span class="n">predicted_probability</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">key_to_idx</span><span class="p">[</span><span class="n">curr_food</span><span class="p">]][</span><span class="n">key_to_idx</span><span class="p">[</span><span class="n">predicted_food</span><span class="p">]]</span>
</code></pre></div></div>

<p>In ra káº¿t quáº£ dá»± Ä‘oÃ¡n</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'MÃ³n Äƒn chÃºng ta Äƒn hÃ´m trÆ°á»›c: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'MÃ³n Äƒn nÃªn Äƒn vÃ o hÃ´m nay lÃ  "</span><span class="si">{</span><span class="n">predicted_food</span><span class="si">}</span><span class="s">"</span><span class="se">\
</span><span class="s"> vá»›i kháº£ nÄƒng xáº£y ra lÃ  </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">predicted_probability</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">%'</span><span class="p">)</span>
</code></pre></div></div>
<pre><code class="language-plain">MÃ³n Äƒn chÃºng ta Äƒn hÃ´m trÆ°á»›c: Phá»Ÿ
MÃ³n Äƒn nÃªn Äƒn vÃ o hÃ´m nay lÃ  "BÃ¡nh mÃ¬" vá»›i kháº£ nÄƒng xáº£y ra lÃ  28.57%
</code></pre>

<p>Váº­y mÃ´ hÃ¬nh Markov chain chÃºng ta Ä‘Ã£ hiá»‡n thá»±c Ä‘Ã£ dá»± Ä‘oÃ¡n cho chÃºng ta mÃ³n â€œBÃ¡nh mÃ¬â€ vÃ o hÃ´m nay.</p>

<p>âš ï¸ <strong>LÆ°u Ã½</strong>: CÃ¡c giÃ¡ trá»‹, sá»‘ liá»‡u Ä‘Æ°á»£c xuáº¥t ra trong bÃ i cÃ³ thá»ƒ khÃ¡c, tÃ¹y thuá»™c vÃ o dá»¯ liá»‡u cung cáº¥p vÃ  sá»± lá»±a chá»n ngáº«u nhiÃªn cá»§a cÃ¡c hÃ m trÃªn.</p>

<p><em>Chi tiáº¿t toÃ n bá»™ code, báº¡n Ä‘á»c cÃ³ thá»ƒ tham kháº£o á»Ÿ <a href="https://github.com/tuanio/tuanio.github.io/blob/main/assets/markov_chain/code/main.ipynb" target="_blank">Ä‘Ã¢y</a></em></p>

<p><a name="-tong-ket"></a></p>

<h3 id="3-tá»•ng-káº¿t">3. Tá»•ng káº¿t</h3>

<p>TrÃªn Ä‘Ã¢y chá»‰ lÃ  má»™t vÃ­ dá»¥ nhá» Ä‘á»ƒ mÃ´ táº£ kháº£ nÄƒng cá»§a Markov chain. Ta cÃ³ thá»ƒ báº¯t gáº·p Markov chain trong nhiá»u bÃ i toÃ¡n khÃ¡c nhÆ° xÃ¢y dá»±ng <a href="https://en.wikipedia.org/wiki/N-gram" target="_blank">mÃ´ hÃ¬nh ngÃ´n ngá»¯ n-gram</a> trong lÄ©nh vá»±c Xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn, cÃ³ thá»ƒ á»©ng dá»¥ng vÃ o viá»‡c <a href="https://en.wikipedia.org/wiki/PageRank" target="_blank">Xáº¿p háº¡ng trang (PageRank)</a> cá»§a Google (nhÆ°ng trÃªn thá»±c táº¿, Google sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh phá»©c táº¡p hÆ¡n Markov chain). Markov chain cÃ³ thá»ƒ phÃ¡t triá»ƒn lÃªn má»™t dáº¡ng khÃ¡c, <a href="https://en.wikipedia.org/wiki/Hidden_Markov_model" target="_blank">mÃ´ hÃ¬nh Markov áº©n</a>, mÃ  cÃ³ thá»ƒ á»©ng dá»¥ng trong bÃ i toÃ¡n <a href="https://en.wikipedia.org/wiki/Speech_recognition" target="_blank">Nháº­n dáº¡ng giá»ng nÃ³i</a>. VÃ  ráº¥t nhiá»u cÃ¡c á»©ng dá»¥ng khÃ¡c trong cÃ¡c lÄ©nh vá»±c Váº­t lÃ½, HÃ³a há»c, Sinh há»c, LÃ½ thuyáº¿t hÃ ng Ä‘á»£i, â€¦ Báº¡n Ä‘á»c cÃ³ thá»ƒ Ä‘á»c thÃªm á»Ÿ Ä‘Æ°á»ng link <a href="https://en.wikipedia.org/wiki/Markov_chain" target="_bank">nÃ y</a>.</p>

:ET